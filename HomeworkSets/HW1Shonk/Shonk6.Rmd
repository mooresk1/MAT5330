---
title: 'Shonkwiler Problem #6'
author: "Stephanie K Moore"
date: "`r Sys.Date()`"
output: html_document
---
## Generating Words from Characters, How Long? ##

6. Generate a sequence of characters from the alphabet {a,b,c,d} with each new character chosen with equal probability and independently of the previous choices.  Now slide a "window" of length 4 along this sequence and record the words that you get.  

How many characters do you expect to have to generate before you see all possible 4^4 = 256 different words?     

Use a simulation to answer this question.  Run the simulation for alphabet sizes of 5, 6, and 7 with window (wordlength)  sizes 4 and 5.      

*To find all possible words, take the alphabet size (A) and raise it to the wordlength (W).*    
*From $4^4$ to $4^7$ and $5^4$ to $5^7$ max words are 256, 625, 1296, 2401, 1024, 3125, 7776, and 16807.*

**Theoretically you might NEVER get all the possible combinations**     

```{r}
abc <- letters[1:7]
wordspercombo <- numeric()
nmult <- numeric()            # records multiplier needed for each combination to capture all possible words 
L <- 1
ltrseq <- vector()
maxmult <- 20        # maximum multiplier we will try before quitting
for (W in 4:5
     ){      # W is window size and word length
  for (A in 4:7){ 
    abet <- abc[1:A]
    n <- A^W   # number of possible "words"
    for (x in 1:maxmult){
      seqlen <- (x*n)+(W-1) # add W-1 to get last few words
      wordlist <- matrix(data=NA,nrow=x*n,ncol=1)
      # Create random sequence of letters
      ltrseq <- paste(sample(abet,seqlen,replace=TRUE),
                     collapse="")
      # Create a list of words
      for (j in 1:(x*n)){   # Create x*n words because some will be duplicates
        wordlist[j] <- substr(ltrseq,j,j+(W-1))
      }
      wordlist <- sort(wordlist)      # Sort the list so duplicates show up together
      keepword <- matrix(data=NA,ncol=1)
      k <- 1
      keepword[1] <- wordlist[1] # 1st word in list sure to be unique
      # Need to keep 1st occurrence, not last occurrence in order to get last word in array
      mstop <- length(wordlist)-1
      # m stops one early since compare is to m+1
      for (m in 1:mstop){ 
        if (k > n) {  # we have found all possible words
          break}
        else {
          if (wordlist[m] != wordlist[m+1]){
            keepword[k+1] <- wordlist[m+1]
            k <- k + 1}
        }
      }
      if (length(keepword) == n) {             # all possible words have been found, get out
        wordspercombo[L] <- length(keepword)   # this array should end up with the max words for each list 
        nmult[L] <- x                          # record multiplier used for this list
        L <- L + 1
        break
      }  # there will be 8 word lists 4^4 to 4^7 and 5^4 to 5^7
    }
  }
}
length(wordlist)
length(keepword)
wordspercombo
```
**This is the 1st 10 and last 10 entries for the last list: (to show it works correctly)**    
*`r keepword[1:10]` and `r keepword[16797:16807]`*    

**The multiplier for each sequence $4^4$ to $4^7$ and $5^4$ to $5^7$ was: `r nmult`.**    

```{r}
sessionInfo()
```