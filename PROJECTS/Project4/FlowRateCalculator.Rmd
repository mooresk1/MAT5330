---
title: "CreekFlowRate"
author: "Stephanie K Moore"
date: "4/5/2016"
output: html_document
---
Measurements were taken 5 days:
Mon 3/28/16 about 6-7 pm
Fri 4/1/16 about 1-2 pm
Sun 4/3/16 about 5-6 pm
Tue 4/5/16 about 5-6 pm
```{r}
library(ggplot2)
library(DT)
# Store temperature for each of 5 days in Fahrenheit #
temp <- matrix(data=c(66,45,67,44,55),nrow=5,ncol=1,byrow=FALSE)
# Convert temp to Celsius #
for (c in 1:5) {
  temp[c] <- (5/9)*(temp[c]-32)
}
pipelen <- 48*2.54/100
# Define a matrix to hold near side, middle and far side depth plus width and volume at 4 locations #
# Data has been converted to meters, doesn't change by day #
mcubedmx <- matrix(data=NA,nrow=4,ncol=5,byrow=TRUE,dimnames=list(c(1:4),c("Near Depth","Mid-Depth","Far Depth","Width","Volume"))) 
mcubedmx[1,] <- c(.1524,.3810,.1778,3.7846,0) 
mcubedmx[2,] <- c(.0889,.1778,.1016,1.6256,0) 
mcubedmx[3,] <- c(.1143,.1651,.0762,2.7432,0) 
mcubedmx[4,] <- c(.2032,.5080,.1397,3.8354,0) 
# Calculate volume of creek at 4 locations #
for (m in 1:4) {
  csect <- .5*mcubedmx[m,4]*(mcubedmx[m,1]+mcubedmx[m,3])+.25*mcubedmx[m,4]*(2*mcubedmx[m,2]-mcubedmx[m,1]-mcubedmx[m,3])
  mcubedmx[m,5] <- csect*pipelen
}
# Define a matrix to hold data for 3 trials each at 4 locations for 5 days #
timemx <- matrix(data=NA,nrow=20,ncol=6,byrow=TRUE,dimnames=list(c(1:20),c("Day","Location","Trial 1","Trial 2","Trial 3","Mean of Trials")))
timemx[1,] <- c(1,1,6.42,6.20,5.63,0)
timemx[2,] <- c(1,2,2.58,2.59,2.66,0)
timemx[3,] <- c(1,3,2.77,3.21,3.10,0)
timemx[4,] <- c(1,4,7.43,8.74,8.22,0) 
for (i in 1:4) {
  timemx[i,6] <- mean(timemx[i,3:5])
}
# Create flow rate matrix to hold 5 days of flow rate data at each of 4 locations #
flowmx <- matrix(data=NA,nrow=5,ncol=4,byrow=TRUE,dimnames=list(c(1:5),c("Loc1","Loc2","Loc3","Loc4")))
for (d in 1:1) {
  for (p in 1:4) {
    flowmx[d,p] <- mcubedmx[p,5]/timemx[p,6]
  }
}

g1 <- ggplot(data = NULL, aes(x = flowmx[1,], y = mcubedmx[,5])) +
  geom_point(color = "red", size = 2) +
  geom_line(linetype = 1, color = "blue") +
  theme_bw() +
  labs(x = "Flow Rate (in m^3/sec)", y = "Volume at Location (in meters cubed)", title = "Flow Rates vs. Volume by Location") 
plot(g1)
```
